{% load static %}
<!DOCTYPE html>
<html lang="en">
  {% load humanize %}
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="shortcut icon" href="{% static "images/favicon.ico" %}" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Instagram</title>
    <link rel="stylesheet" href="{% static "sass/vender/bootstrap.css" %}">
    <link rel="stylesheet" href="{% static "sass/vender/bootstrap.min.css" %}">
    <link rel="stylesheet" href="{% static
    "owlcarousel/owl.theme.default.min.css" %}"> <link rel="stylesheet" href="{%
    static "owlcarousel/owl.carousel.min.css" %}"> <link rel="stylesheet"
    href="{% static
    "https://cdnjs.cloudflare.com/ajax/libs/emojionearea/3.4.2/emojionearea.min.css"
    %}"> <link rel="stylesheet" href="{% static "sass/main.css" %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
    .container-fluid{
      display:flex;
      margin-top: 40px;
      padding:12px 45px;
    }
    .post-card {
        overflow: hidden;
        cursor: pointer;
    }
    
    .post-card img {
        transition: transform 0.3s ease-in-out;
    }
    
    .post-card:hover img {
        transform: scale(1.1);
    }
    
    .post-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
        color: #fff;
    }
    
    .post-card:hover .post-overlay {
        opacity: 1;
    }
    @media (max-width: 760px) {
      .container-fluid{
        display:flex;
        overflow-y: scroll;
        flex-direction: column;
        justify-content: center;
        margin-top: 2px;
        padding:2;
        }
  }
  .edit-profile-input {
	border: 2px #dddddd solid;
}

.about-input {
	border-radius: 20px;
}

div#masonry {
	display: -ms-flexbox;
	-ms-flex-direction: column;
	-ms-flex-wrap: wrap;
	display: flex;
	flex-direction: column;
	flex-wrap: wrap;
	height: 200vw;
	width: 290px;
	margin: 0;
}

div#masonry img,
div#masonry video {
	width: 100%;
	border-radius: 20px;
	cursor: zoom-in;
}

.modal {
	display: none;
	position: fixed;
	z-index: 1;
	left: 0;
	top: 0;
	height: 100%;
	width: 100%;
	overflow: auto;
	background-color: rgba(0, 0, 0, 0.658);
}

.modal-content {
	background-color: #ffffff;
	margin: 10% auto;
	width: 40%;
	box-shadow: 0 5px 8px 0 rgba(0, 0, 0, 0.2), 0 7px 20px 0 rgba(0, 0, 0, 0.17);
	animation-name: modalopen;
	animation-duration: 1s;
	border-radius: 35px;
}

@keyframes modalopen {
	from {
		opacity: 0;
	}

	to {
		opacity: 1;
	}
}

.img-container {
	position: relative;
}

.img-container .edit-btn {
	position: absolute;
	top: 72%;
	left: 98%;
	transform: translate(-50%, -50%);
	-ms-transform: translate(-50%, -50%);
	font-size: 18px;
	padding: 10px;
	border: none;
	cursor: pointer;
	border-radius: 90%;
	text-align: center;
}

.edit-btn {
	display: none;
	background-color: white;
	border-radius: 90%;
}

.img-container img:hover+.edit-btn {
	display: inline-block;
}

.description-input {
	border-radius: 30px;
}

.board-input {
	border-radius: 30px 0px 0px 30px;
}


.pin-detail-container {
	box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
	border-radius: 30px;
	margin-bottom: 15px;
}

header,
.first-header {
	box-shadow: rgba(89, 89, 92, 0.041) 0px 7px 5px 0px;
}

.btn {
	border-radius: 50px;
}

.following-btn {
	background-color: #0e0e0e;
}

.main-btn {
	background-color: #efefef;
}

.red-btn {
	background-color: #e60023;
}

.modal-red-btn {
	background-color: #e60023;
	float: right;
	font-weight: bold;
}

.btn-select-border {
	border-bottom: 2px black solid;
}

.save-btn {
	background-color: #e60023;
	border-radius: 0 30px 30px 0;
	border: 0;
	padding-top: 7px;
	padding-bottom: 7px;
	padding-left: 7px;
	padding-right: 10px;
	margin-left: -25px;
}

.pin-detail-img {
	height: fit-content;
	width: 400px;
	border-radius: 20px;
	margin-left: -15px;
}

.edit-pin-modal {
	background-color: #ffffff;
	margin: 10% auto;
	width: 70%;
	box-shadow: 0 5px 8px 0 rgba(0, 0, 0, 0.2), 0 7px 20px 0 rgba(0, 0, 0, 0.17);
	animation-name: modalopen;
	animation-duration: 1s;
	border-radius: 35px;
	overflow: auto;
}

.video {
	object-fit: cover;
	width: 200px;
	height: 300px;
	border-radius: 20px;
}

.edit-modal-video {
	object-fit: cover;
	width: 280px;
	height: 480px;
}

.edit-modal-img {
	border-radius: 20px;
	width: 280px;
	height: auto;
}

.comment-text-border {
	border-radius: 20px;
}

.private-checkbox {
	float: left;
}

.login-bg {
	background-image: url('../../media/background.jpg');
	background-repeat: no-repeat;
	background-size: cover;
}

@media(max-width:760px){
	div#masonry {
		display: -ms-flexbox;
		-ms-flex-direction: row;
		-ms-flex-wrap: wrap;
		display: flex;
		flex-direction: row;
		flex-wrap: wrap;
		height: 100vw;
		width: 290px;
		margin: 0;
	}
	
}
    </style>
  </head>

  <body>
    <div class="post_page">
          <!--***** nav menu start ****** -->
          <div class="nav_menu">
            <div class="fix_top">
                <!-- nav for big->medium screen -->
                <div class="nav">
                    <div class="logo">
                        <a href="{% url "home" %}">
                            <img class="d-block d-lg-none small-logo" src="{% static "images/instagram.png" %}" alt="logo">
                            <img class="d-none d-lg-block" src=" {% static "images/logo_menu.png" %}" alt="logo">
                        </a>
                    </div>
                    <div class="menu">
                        <ul>
                            <li>
                                <a class="active" href="{% url "home" %}">
                                    <img src=" {% static "images/accueil.png"  %}">
                                    <span class="d-none d-lg-block ">Home</span>
                                </a>
                            </li>
                            <li id="search_icon">
                                <a href="#">
                                    <img src=" {% static "images/search.png"  %}">
                                    <span class="d-none d-lg-block search">Search </span>
                                </a>
                            </li>
                            <li>
                                <a href="{% url "explore" %}">
                                    <img src=" {% static "images/compass.png"  %}">
                                    <span class="d-none d-lg-block ">Explore</span>
                                </a>
                            </li>
                            <li>
                                <a href="./reels.html">
                                    <img src=" {% static "images/video.png"  %}">
                                    <span class="d-none d-lg-block ">Reels</span>
                                </a>
                            </li>
                            <li>
                                <a href="{% url 'inbox' %}">
                                    <img src=" {% static "images/send.png"  %}">
                                    <span class="d-none d-lg-block ">
                                        Messages
                                    {% if directs_count %}
                                    <span class="badge">{{ directs_count }}</span>
                                    {% endif %}
                                </span>
                                </a>
                            </li>
                            
                            <li class="notification_icon">
                                <a href="#">
                                    <img src=" {% static "images/love.png"  %}">
                                    <span class="d-none d-lg-block ">Notifications
                                        {% if count_notifications %}
                                       <span class="badge">{{ count_notifications }}</span>
                                       {% endif %}

                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="#" data-bs-toggle="modal" data-bs-target="#create_modal">
                                    <img src=" {% static "images/tab.png"  %}">
                                    <span class="d-none d-lg-block ">Create</span>
                                </a>

                            </li>
                            <li>
                                <a href="{% url 'profile' request.user %}">
                                {% if profile.picture %}
                                    <img class="circle story"  src="{{ profile.picture.url }}">
                                  {% else %}
                                    <img class="circle story"  src="{% static "images/user.png" %}">
                                  {% endif %}
                                  <span class="d-none d-lg-block ">Profile</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="more">
                        <div class="btn-group dropup">
                            <button type="button" class="btn dropdown-toggle" data-bs-toggle="dropdown"
                                aria-expanded="false">
                                <img src="{%  static "images/menu.png"  %}">
                                <span class="d-none d-lg-block ">More</span>
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">
                                        <span>Settings</span>
                                        <img src="./images/reglage.png">
                                    </a></li>
                                <li><a class="dropdown-item" href="#">
                                        <span>Your activity</span>
                                        <img src="./images/history.png">
                                    </a></li>
                                <li><a class="dropdown-item" href="#">
                                        <span>Saved</span>
                                        <img src="./images/save-instagram.png">
                                    </a></li>
                                <li><a class="dropdown-item" href="#">
                                        <span>Switch apperance</span>
                                        <img src="./images/moon.png">
                                    </a></li>
                                <li><a class="dropdown-item" href="#">
                                        <span>Report a problem</span>
                                        <img src="./images/problem.png">
                                    </a></li>
                                <li><a class="dropdown-item bold_border" href="#">
                                        <span>Switch accounts</span>
                                    </a></li>
                                <li><a class="dropdown-item" href="./login.html">
                                        <span>Log out</span>
                                    </a></li>
                            </ul>
                        </div>
                        <!--  -->

                    </div>
                </div>
                <!-- nav for small screen  -->
                <div class="nav_sm">
                    <div class="content">
                        <div class="dropdown">
                            <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown"
                                aria-expanded="false">
                                <img class="logo" src="{% static "images/logo_menu.png"%}"/>
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">
                                        <span>Following</span>
                                        <img src="{% static "images/add-friend.png"%}"/>
                                    </a>
                                </li>
                                <li><a class="dropdown-item" href="#">
                                        <span>Favorites</span>
                                        <img src="{% static "images/star.png"%}"/>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="left">
                            <div class="search_bar">
                                <div class="input-group">
                                    <div class="form-outline">
                                        <div>
                                            <img src="{% static "images/search.png"%}"/ alt="search">
                                        </div>
                                        <input type="search" id="form1" class="form-control" placeholder="Search" />
                                    </div>
                                </div>
                            </div>
                            <div class="notifications notification_icon">
                                <a href="notification.html">
                                    <img src="{% static "images/love.png"%}"/>
                                </a>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- nav for ex-small screen  -->
                <div class="nav_xm">
                    <div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            <img class="logo" src="{% static "images/logo_menu.png"%}"/>
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">
                                    <span>Following</span>
                                    <img src="{% static "images/add-friend.png"%}"/>
                                </a></li>
                            <li><a class="dropdown-item" href="#">
                                    <span>Favorites</span>
                                    <img src="{% static "images/star.png"%}"/>
                                </a></li>
                        </ul>
                    </div>
                    <div class="left">

                        <img src="{% static "images/send.png"%}"/>
                        <a href="notification.html">
                            <img class="notification_icon" src="{% static "images/love.png"%}"/>
                        </a>

                    </div>
                </div>
            </div>
            <!-- menu in the botton for smal screen  -->
            <div class="nav_bottom">
                <a href="/"><img src="{% static "images/accueil.png" %}"/></a>
                <a href="{% url "explore" %}"><img src="{% static "images/compass.png" %}"/></a>
                <a href=" reels.html"><img src="{% static "images/video.png" %}"/></a>
                <a href="#" data-bs-toggle="modal" data-bs-target="#create_modal"><img src="{% static "images/tab.png" %}"/></a>
                <a href="{% url "profile" request.user%}">     
                        {% if profile.picture %}
                        <img class="circle story"  src="{{ profile.picture.url }}">
                      {% else %}
                        <img class="circle story"  src="{% static "images/user.png" %}">
                      {% endif %}
                </a>
            </div>
        </div>
        <!-- search  -->
        <div id="search" class="search_section" >
            <h2>Search</h2>
            <form method="GET" action="{% url 'home' %}">
                <input type="text" name="search" placeholder="Search users">
            </form>
            <div class="find">
                <div class="desc">
                    <h4>Recent</h4>
                    <p><a href="#">Clear all</a></p>
                </div>
                <div class="account">
                                        
                    {% if searched_users %}
                    {% for user in searched_users %}
                    <div class="cart">
                        <div>
                            <div class="img">
                                <a href="{% url 'profile' user.username %}">
                                {% if user.profile.picture %}
                                    <img src="{{ user.profile.picture.url }}" alt="{{ user.username }} profile picture">
                                {% else %}
                                    <img src="{% static 'images/user.png' %}" alt="Placeholder profile picture">
                                {% endif %}
                                </a>
                            </div>
                            <div class="info">
                                <p class="name">           
                                    {{ user.first_name }} {{ user.last_name }}
                                </p>
                                <p class="second_name">@{{ user.username }}</p>
                                <p>Followers: {{ user.follower_count }}</p>
                            </div>
                        </div>
                        <div class="clear">
                            <a href="#">X</a>
                        </div>
                    </div>
                    {% endfor %}
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- search  -->
        <!-- notification -->
        <div id="notification" class="notification_section">
            {% if notifications %}
            <h2>Notifications</h2>
  
            <div class="notifications">
                          
           {% for notification in notifications %}
                {% if notification.notification_type == 3 %}
                <div class="notif follow_notif">
                    <div class="cart">
                        <div>
                            <div class="img">
                                {% if notification.sender.profile.picture %}
                                <img src="{{ notification.sender.profile.picture.url }}" alt="Placeholder image">
                              {% else %}
                                <img src="{% static "images/user.png" %}" alt="Placeholder image">
                            {% endif %}
                            </div>
                            <div class="info">
                                <p class="name">
                                    {{ notification.sender.profile.first_name }} {{ notification.sender.profile.last_name }}</strong> <small>@{{ notification.sender.username }}
                                    <span class="desc">started following you.</span>
                                    <span class="time">{{ notification.date|naturaltime }}</span>
                                </p>

                            </div>
                        </div>
                        <div class="follow_you">
                            <button class="follow_text">Follow</button>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% comment %} <div class="notif follow_notif">
                    <div class="cart">
                        <div>
                            <div class="img">
                                <img src="./images/profile_img.jpg" alt="">
                            </div>
                            <div class="info">
                                <p class="name">
                                    Zineb_essoussi
                                    <span class="desc">started following you.</span>
                                    <span class="time">2h</span>
                                </p>

                            </div>
                        </div>
                        <div class="follow_you">
                            <button class="follow_text">Follow</button>
                        </div>
                    </div>
                </div> {% endcomment %}
                {% if notification.notification_type == 1 %}
                <div class="notif story_notif">
                    <div class="cart">
                        <div>
                            <div class="img">
                                {% if notification.sender.profile.picture %}
                                <img src="{{ notification.sender.profile.picture.url }}" alt="Placeholder image">
                              {% else %}
                                <img src="{% static "images/user.png" %}" alt="Placeholder image">
                            {% endif %}                            </div>
                            <div class="info">
                                <div class="info">
                                    <p class="name">
                                        {{ notification.sender.profile.first_name }} {{ notification.sender.profile.last_name }}</strong> <small>@{{ notification.sender.username }}
                                        <span class="desc">liked your Post.</span>
                                        <span class="time">{{ notification.date|naturaltime }}</span>
                                    </p>

                                </div>
                            </div>
                        </div>
                        <div class="story_like">
                            <img src="{{ notification.post.picture.url }}">                        </div>
                    </div>
                </div>
                {% endif %}

            {% endfor %}
            </div>
            {% endif %}
        </div>
      {% comment %} <!--***** nav menu end ****** -->
      <div class="explore_container">
        {% for post in posts %}
        <div class="items_4">
            <div class="item">
                <img class="img-fluid" src="{{post.picture.url }}" >
                <div class="bg">
                  <div class="info">
                    <div class="likes">
                        <img src="./images/heart_white.png" >
                        <span>${explore_date[i][1]}</span>
                    </div>
                    <div class="comments">
                        <img src="./images/message.png" >
                        <span>${explore_date[i++][2]}</span>
                    </div>
                  </div>
                </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div> {% endcomment %}

      <!-- explore.html -->


      {% block content %}
      <div id="masonry">
        {% for post in posts %}
        <a class="m-2" href="{% url 'postdetails' post.id%}">
            {% if post.get_type == 'video' %}
            <video autoplay muted loop>
                <source src="{{post.picture.url }}">
            </video>
            {% else %}
            <img src="{{post.picture.url }}">
            {% endif %}
        </a>
        {% endfor %}
    </div>
      {% comment %} <div class="container-fluid px-6">
          <div class="row g-3">
              {% for post in posts %}
              <div class="col-6 col-sm-4 col-md-3 col-lg-2">
                  <div class="post-card position-relative">
                    {% if post.get_type == 'video' %}
                    <video class="video" autoplay muted loop>
                        <source src="{{post.picture.url }}">
                    </video>
                    {% else %}
                    <img src="{{post.picture.url }}">
                    {% endif %}                      <div class="post-overlay d-flex justify-content-between align-items-center p-2">
                          <div class="likes">
                              <i class="fas fa-heart"></i> {{ post.likes }}
                          </div>
                          <div class="comments">
                              <i class="fas fa-comment"></i> {{ post.comments.count }}
                          </div>
                      </div>
                  </div>
              </div>
              {% endfor %}
          </div>
          {% if is_paginated %}
          <nav aria-label="Page navigation">
              <ul class="pagination justify-content-center">
                  {% if page_obj.has_previous %}
                  <li class="page-item">
                      <a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">
                          <span aria-hidden="true">&laquo;</span>
                      </a>
                  </li>
                  {% endif %}
                  {% for i in page_obj.paginator.page_range %}
                  {% if page_obj.number == i %}
                  <li class="page-item active"><a class="page-link" href="#">{{ i }}</a></li>
                  {% else %}
                  <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
                  {% endif %}
                  {% endfor %}
                  {% if page_obj.has_next %}
                  <li class="page-item">
                      <a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">
                          <span aria-hidden="true">&raquo;</span>
                      </a>
                  </li>
                  {% endif %}
              </ul>
          </nav>
          {% endif %}
      </div> {% endcomment %}
      {% endblock %}
      

      <!--Create model-->
      <div
        class="modal fade"
        id="create_modal"
        tabindex="-1"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h1
                class="modal-title w-100 fs-5 d-flex align-items-end justify-content-between"
                id="exampleModalLabel"
              >
                <span class="title_create">Create new post</span>
                <button class="next_btn_post btn_link"></button>
              </h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <img class="up_load" src="./images/upload.png" alt="upload" />
              <p>Drag photos and videos here</p>
              <button class="btn btn-primary btn_upload">
                select from your computer
                <form id="upload-form">
                  <input
                    class="input_select"
                    type="file"
                    id="image-upload"
                    name="image-upload"
                  />
                </form>
              </button>
              <div id="image-container" class="hide_img"></div>
              <div id="image_description" class="hide_img">
                <div class="img_p"></div>
                <div class="description">
                  <div class="cart">
                    <div>
                      <div class="img">
                        <img src="./images/profile_img.jpg" />
                      </div>
                      <div class="info">
                        <p class="name">Zineb_essoussi</p>
                      </div>
                    </div>
                  </div>
                  <form>
                    <textarea
                      type="text"
                      id="emoji_create"
                      placeholder="write your email"
                    ></textarea>
                  </form>
                </div>
              </div>
              <div class="post_published hide_img">
                <img src="./images/uploaded_post.gif" alt="" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
   <!-- <script src="./sass/vender/bootstrap.bundle.js"></script>
    <script src="./sass/vender/bootstrap.bundle.min.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js" integrity="sha384-zYPOMqeu1DAVkHiLqWBUTcbYfZ8osu1Nd6Z89ify25QV9guujx43ITvfi12/QExE" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js" integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ" crossorigin="anonymous"></script>
    <script src="{% static "owlcarousel/jquery.min.js" %}"></script>
    <script src="{% static "owlcarousel/owl.carousel.min.js" %}"></script>
    <script src="{% static "js/carousel.js" %}"></script>
    <script src="{% static "js/init.js" %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/emojionearea/3.4.2/emojionearea.min.js"></script>
    <script src="{% static "js/main.js" %}"></script>
</body>

</html>
